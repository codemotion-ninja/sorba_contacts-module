!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/router"),require("@angular/common"),require("@ionic/angular"),require("rxjs/operators"),require("rxjs"),require("@ionic-native/keyboard/ngx"),require("@ionic-native/keyboard/ngx/index"),require("@ionic-native/in-app-browser/ngx"),require("@ionic-native/in-app-browser/ngx/index"),require("graphql-tag"),require("apollo-angular"),require("immutability-helper"),require("@sorba-app/sorba-ui-components"),require("@angular/forms"),require("@agm/core"),require("@ionic-native/document-viewer/ngx"),require("@ionic-native/file/ngx"),require("@ionic-native/file-opener/ngx"),require("@angular/cdk/scrolling"),require("@angular/platform-browser"),require("angular-resizable-element")):"function"==typeof define&&define.amd?define("contacts",["exports","@angular/core","@angular/router","@angular/common","@ionic/angular","rxjs/operators","rxjs","@ionic-native/keyboard/ngx","@ionic-native/keyboard/ngx/index","@ionic-native/in-app-browser/ngx","@ionic-native/in-app-browser/ngx/index","graphql-tag","apollo-angular","immutability-helper","@sorba-app/sorba-ui-components","@angular/forms","@agm/core","@ionic-native/document-viewer/ngx","@ionic-native/file/ngx","@ionic-native/file-opener/ngx","@angular/cdk/scrolling","@angular/platform-browser","angular-resizable-element"],e):e((t=t||self).contacts={},t.ng.core,t.ng.router,t.ng.common,t["@ionic/angular"],t.rxjs.operators,t.rxjs,t["@ionic-native/keyboard/ngx"],t["@ionic-native/keyboard/ngx/index"],t["@ionic-native/in-app-browser/ngx"],t["@ionic-native/in-app-browser/ngx/index"],t["graphql-tag"],t["apollo-angular"],t["immutability-helper"],t["@sorba-app/sorba-ui-components"],t.ng.forms,t["@agm/core"],t["@ionic-native/document-viewer/ngx"],t["@ionic-native/file/ngx"],t["@ionic-native/file-opener/ngx"],t.ng.cdk.scrolling,t.ng.platformBrowser,t["angular-resizable-element"])}(this,(function(t,e,n,i,o,r,a,s,c,l,p,d,u,h,f,m,b,g,y,v,x,w,I){"use strict";d=d&&d.hasOwnProperty("default")?d.default:d,h=h&&h.hasOwnProperty("default")?h.default:h;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function k(t,e){function n(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var S=function(){return(S=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function j(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(a,s)}c((i=i.apply(t,e||[])).next())}))}function M(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function A(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function P(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function D(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var T={contacts:"contacts",contact:"contact",notifications:"notifications"},$="up",N="down",L="download",H="copy",_="file",E="folder",O={contacts:"Contacts"};var U="user",F="company",q={jpg:"jpg",jpeg:"jpeg",pdf:"pdf",docx:"docx",xslx:"xslx",xls:"xls"};var B=["cut","copy","delete","edit","download"],z=[{count:0,type:"all",label:"All contacts",active:!0},{count:0,type:U,label:"User contacts",active:!1},{count:0,type:F,label:"Company contacts",active:!1}],R=[{menuItemIcon:"contact",menuItemName:"Contact list",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"outlook",menuItemName:"Outlook export",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"report",menuItemName:"Reports",menuItemLink:"#/contacts/contact",subMenu:[{subMenuItemName:"Number ranges",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Default values",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Address import",subMenuItemLink:"#/contacts/contact"}]},{menuItemIcon:"mutations",menuItemName:"Global mutations",menuItemLink:"#/contacts/contact",subMenu:[]},{menuItemIcon:"settings-filled",menuItemName:"Settings",menuItemLink:"#/contacts/contact",subMenu:[{subMenuItemName:"Number ranges",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Default values",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Address import",subMenuItemLink:"#/contacts/contact"},{subMenuItemName:"Subdivisions",subMenuItemLink:"#/contacts/contact"}]}],W={PRIVACY_POLICY:"privacy-policy",TERMS_OF_SERVICE:"/assets/docs/2019_AGB_SORBA_EDV_AG.pdf",HELP_CENTER:"https://support.sorba.ch/hc/de"},V={clearcache:"yes",clearsessioncache:"yes",hideurlbar:"yes",location:"no",zoom:"no"},G="mobile",Q="android",K="ios",Y="mobileweb",J="desktop",X="tablet";function Z(t){return t.join(" ").trim().replace(/\s{2,}/g," ")}var tt=function(){function t(t){this.appService=t,this.isMobile=window.innerWidth<768,this.isDesktop=window.innerWidth>1023,this.excludeSearchFields=["__typename","picture","id"],this.activeContact=new a.BehaviorSubject(null),this.headerData={title:O.contacts,path:"/"}}return t.prototype.searchBySymbol=function(t,e){var n=this;if(0===t.length)return[];var i=e.toLowerCase(),o=Object.keys(t[0]).filter((function(t){return!n.excludeSearchFields.includes(t)}));if(0===o.length)return[];var r=[];return t.forEach((function(t){var e,n,a=Z([t.first_name,t.name])||"[Unnamed]";try{for(var s=A(o),c=s.next();!c.done;c=s.next()){var l=c.value;if("string"==typeof t[l]&&t[l].length>0&&t[l].toLowerCase().includes(i))return void r.push(S({},t,{subText:t[l],text:a}));r.push(S({},t,{subText:"",text:a}))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}})),r},t.prototype.getMobileHeight=function(t){return"calc(100vh - var(--header-height) - var(--ion-safe-area-top, 0) - "+t+")"},t.prototype.getActiveDomain=function(){return this.appService.getActiveDomain().pipe(r.map((function(t){return t.name})))},t.prototype.getDownLoadPath=function(t,e){return j(this,void 0,void 0,(function(){var n;return M(this,(function(i){switch(i.label){case 0:return[4,this.appService.getToken().toPromise()];case 1:return n=i.sent(),[2,this.appService.environment.BASE_URL+"/download/"+e+"?path="+t+"&auth_token="+n]}}))}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("appService"))},token:t,providedIn:"root"}),t}();var et=function(){function t(t,e){var n=this;this.keyboard=t,this.platform=e,this.keyboardHeight$=new a.BehaviorSubject(null),window.addEventListener("keyboardDidHide",(function(){return n.keyboardHeight$.next(null)})),window.addEventListener("keyboardWillShow",(function(t){return n.keyboardHeight$.next(t.keyboardHeight)}))}return t.prototype.setKeyboardMode=function(){return j(this,void 0,void 0,(function(){return M(this,(function(t){switch(t.label){case 0:return[4,this.platform.is("desktop")];case 1:return t.sent()||this.keyboard.setResizeMode(s.KeyboardResizeMode.Native),[2]}}))}))},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:s.Keyboard},{type:o.Platform}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(c.Keyboard),e.ɵɵinject(o.Platform))},token:t,providedIn:"root"}),t}();var nt=function(){function t(t){this.iab=t}return t.prototype.redirect=function(t,e){t.preventDefault(),this.iab.create(e,"_blank",V)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:l.InAppBrowser}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(p.InAppBrowser))},token:t,providedIn:"root"}),t}();var it=function(){function t(t){this.plt=t}return t.prototype.isMobileWeb=function(){return this.plt.is(Y)},t.prototype.isDesktop=function(){return this.plt.is(J)},t.prototype.isMobileApp=function(){return this.plt.is(G)},t.prototype.isIOS=function(){return this.plt.is(K)},t.prototype.isAndroid=function(){return this.plt.is(Q)},t.prototype.isTablet=function(){return this.plt.is(X)},t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:o.Platform}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(o.Platform))},token:t,providedIn:"root"}),t}();var ot=d(bt||(bt=D(["\n    fragment ContactAppInfo on AppContact {\n  picture(width: 40, height: 40)\n  first_name\n  name\n  id\n}\n    "],["\n    fragment ContactAppInfo on AppContact {\n  picture(width: 40, height: 40)\n  first_name\n  name\n  id\n}\n    "]))),rt=d(gt||(gt=D(["\n    fragment ContactAppAddress on AppContact {\n  address\n  postal_code\n  city\n  po_box\n}\n    "],["\n    fragment ContactAppAddress on AppContact {\n  address\n  postal_code\n  city\n  po_box\n}\n    "]))),at=d(yt||(yt=D(["\n    fragment SearchContactAppInfo on AppContact {\n  business_number\n  mobile_number\n  private_number\n  fax\n  website\n  logical20\n  ...ContactAppInfo\n  ...ContactAppAddress\n}\n    ","\n",""],["\n    fragment SearchContactAppInfo on AppContact {\n  business_number\n  mobile_number\n  private_number\n  fax\n  website\n  logical20\n  ...ContactAppInfo\n  ...ContactAppAddress\n}\n    ","\n",""])),ot,rt),st=d(vt||(vt=D(["\n    fragment AppProjectInfo on AppProject {\n  id\n  name\n  description\n  order_no\n  offer_total\n  responsible\n  denied\n  done\n  warranty\n  in_progress\n  do_not_calculate\n  acquisition\n  replicating\n  archives\n  offer\n}\n    "],["\n    fragment AppProjectInfo on AppProject {\n  id\n  name\n  description\n  order_no\n  offer_total\n  responsible\n  denied\n  done\n  warranty\n  in_progress\n  do_not_calculate\n  acquisition\n  replicating\n  archives\n  offer\n}\n    "]))),ct=d(xt||(xt=D(["\n    query ContactApps($domain: String!, $page: UInt!, $perPage: UInt!, $filter: ContactAppFilterInput) {\n  contactApps(domain: $domain, page: $page, perPage: $perPage, filter: $filter) {\n    items {\n      ...ContactAppInfo\n    }\n    pageInfo {\n      totalCount\n    }\n    aggregatedInfo {\n      companiesContactsCount\n      usersContactsCount\n    }\n  }\n}\n    ",""],["\n    query ContactApps($domain: String!, $page: UInt!, $perPage: UInt!, $filter: ContactAppFilterInput) {\n  contactApps(domain: $domain, page: $page, perPage: $perPage, filter: $filter) {\n    items {\n      ...ContactAppInfo\n    }\n    pageInfo {\n      totalCount\n    }\n    aggregatedInfo {\n      companiesContactsCount\n      usersContactsCount\n    }\n  }\n}\n    ",""])),ot),lt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.document=ct,e}return k(n,t),n.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],n.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new n(e.ɵɵinject(u.Apollo))},token:n,providedIn:"root"}),n}(u.Query);var pt=d(wt||(wt=D(["\n    query SearchContacts($domain: String!, $page: UInt!, $perPage: UInt!, $filter: ContactAppFilterInput) {\n  contactApps(domain: $domain, page: $page, perPage: $perPage, filter: $filter) {\n    items {\n      ...SearchContactAppInfo\n    }\n  }\n}\n    ",""],["\n    query SearchContacts($domain: String!, $page: UInt!, $perPage: UInt!, $filter: ContactAppFilterInput) {\n  contactApps(domain: $domain, page: $page, perPage: $perPage, filter: $filter) {\n    items {\n      ...SearchContactAppInfo\n    }\n  }\n}\n    ",""])),at),dt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.document=pt,e}return k(n,t),n.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],n.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new n(e.ɵɵinject(u.Apollo))},token:n,providedIn:"root"}),n}(u.Query);var ut=d(It||(It=D(["\n    query ContactAppByID($id: ID!, $domain: String!) {\n  contactAppById(id: $id, domain: $domain) {\n    ...SearchContactAppInfo\n    memo\n    projects {\n      ...AppProjectInfo\n    }\n    documents\n    contacts {\n      ...ContactAppInfo\n      ...ContactAppAddress\n    }\n    geocode_address {\n      lat\n      lon\n    }\n  }\n}\n    ","\n","\n","\n",""],["\n    query ContactAppByID($id: ID!, $domain: String!) {\n  contactAppById(id: $id, domain: $domain) {\n    ...SearchContactAppInfo\n    memo\n    projects {\n      ...AppProjectInfo\n    }\n    documents\n    contacts {\n      ...ContactAppInfo\n      ...ContactAppAddress\n    }\n    geocode_address {\n      lat\n      lon\n    }\n  }\n}\n    ","\n","\n","\n",""])),at,st,ot,rt),ht=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.document=ut,e}return k(n,t),n.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],n.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new n(e.ɵɵinject(u.Apollo))},token:n,providedIn:"root"}),n}(u.Query);var ft=d(Ct||(Ct=D(["\n    query AppContactUserSettings($userId: ID!) {\n  appContactUserSettings(userId: $userId) @client {\n    extendedLayout\n    contactListWidth\n    __typename\n  }\n}\n    "],["\n    query AppContactUserSettings($userId: ID!) {\n  appContactUserSettings(userId: $userId) @client {\n    extendedLayout\n    contactListWidth\n    __typename\n  }\n}\n    "]))),mt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.document=ft,e}return k(n,t),n.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],n.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new n(e.ɵɵinject(u.Apollo))},token:n,providedIn:"root"}),n}(u.Query);var bt,gt,yt,vt,xt,wt,It,Ct,kt,St=d(kt||(kt=D(["\n    mutation UpdateAppContactUserSettings($userId: ID!, $appContactUserSettings: AppContactUserSettingsInput!) {\n  updateAppContactUserSettings(userId: $userId, appContactUserSettings: $appContactUserSettings) @client {\n    extendedLayout\n    __typename\n  }\n}\n    "],["\n    mutation UpdateAppContactUserSettings($userId: ID!, $appContactUserSettings: AppContactUserSettingsInput!) {\n  updateAppContactUserSettings(userId: $userId, appContactUserSettings: $appContactUserSettings) @client {\n    extendedLayout\n    __typename\n  }\n}\n    "]))),jt=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.document=St,e}return k(n,t),n.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],n.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new n(e.ɵɵinject(u.Apollo))},token:n,providedIn:"root"}),n}(u.Mutation);var Mt=function(){function t(t,e){var n=this;this.appService=t,this.appContactUserSettingsGql=e,this.appContactUserSettings$=this.appService.getToken().pipe(r.switchMap((function(t){var e=JSON.parse(atob(t.split(".")[1])).id;return n.appContactUserSettingsGql.watch({userId:e}).valueChanges})),r.map((function(t){var e=t.data;return e&&e.appContactUserSettings||{}})),r.shareReplay({refCount:!0,bufferSize:1})),this.extendedMode$=this.appContactUserSettings$.pipe(r.map((function(t){return t.extendedLayout||!1}))),this.contactListWidth$=this.appContactUserSettings$.pipe(r.map((function(t){return t.contactListWidth})),r.filter((function(t){return t>0})),r.distinctUntilChanged())}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]},{type:mt}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject("appService"),e.ɵɵinject(mt))},token:t,providedIn:"root"}),t}();var At=function(){function t(t,e,n,i,o,s,c,l,p,d){var u=this;this.document=t,this.appsService=e,this.updateAppContactUserSettingsGql=n,this.contactsHelper=i,this.contactListGQL=o,this.router=s,this.cd=c,this.keyboardHelper=l,this.platform=p,this.contactSettings=d,this.windowWidth=window.innerWidth,this.menuData=R,this.showMenu=!1,this.menuItems=z.map((function(t){return S({},t)})),this.contactsList=[],this.unsubscribe$=new a.Subject,this.isMobile=this.contactsHelper.isMobile,this.mobileHeight=this.contactsHelper.getMobileHeight("152px"),this.searchText="",this.itemsPerPage=100,this.isLoading=!0,this.keyboardHeight=0,this.setContactsGql().then((function(){u.updateOnChangeDomain()})),d.contactListWidth$.pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.documentElement.style.setProperty("--contacts-list-width",e+"px")})),this.contactsHelper.headerData={title:O.contacts,path:"/"}}return Object.defineProperty(t.prototype,"menuFloat",{get:function(){return this.platform.is(X)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desktopHeight",{get:function(){if(this.isMobile)return this.platform&&this.platform.height()&&this.platform.height()-this.keyboardHeight;var t=this.document.querySelector("#sr-content-main > ion-content").shadowRoot.querySelector("main"),e=this.document.querySelector(".contacts-list-wrapper");if(t&&e){var n=t.scrollHeight-t.clientHeight;return t.scrollTop>n-117?e.offsetHeight-(t.scrollTop-(n-117)):e.offsetHeight}return 0},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.ngAfterViewInit=function(){var t=this;(this.toggleMenu(),this.keyboardHelper.setKeyboardMode(),this.getKeyBoardHeight(),this.isMobile)||this.document.querySelector("#sr-content-main > ion-content").shadowRoot.querySelector("main").addEventListener("scroll",(function(){t.cd.detectChanges()}))},t.prototype.ngAfterContentChecked=function(){this.cd.detectChanges()},t.prototype.getOffset=function(t){return t&&t[0]&&t[0].offsetHeight||0},t.prototype.getKeyBoardHeight=function(){var t=this;setTimeout((function(){var e=t.document.getElementsByClassName("main-header"),n=t.sideMenu.nativeElement.getElementsByClassName("menu-float-button"),i=t.getOffset(n);t.keyboardHeight+=96+t.getOffset(e),t.keyboardHelper.keyboardHeight$.pipe(r.takeUntil(t.unsubscribe$)).subscribe((function(e){e?t.keyboardHeight-=i:t.keyboardHeight+=i}))}))},t.prototype.updateOnChangeDomain=function(){var t=this;this.contactsHelper.getActiveDomain().pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.resetSearch=e,t.resetVariables(e),t.contactsQueryRef.refetch(t.gqlVariables).then((function(){t.menuItems.forEach((function(t){t.active=z.find((function(e){return e.type===t.type})).active}))}))}))},t.prototype.setContactsGql=function(){return j(this,void 0,void 0,(function(){var t,e=this;return M(this,(function(n){switch(n.label){case 0:return[4,this.contactsHelper.getActiveDomain().pipe(r.take(1)).toPromise()];case 1:return t=n.sent(),this.resetVariables(t),this.contactsQueryRef=this.contactListGQL.watch(this.gqlVariables),this.contactsQueryRef.valueChanges.pipe(r.filter((function(t){return!t.loading})),r.switchMap((function(t){var e=t.data,n=t.errors;return n?a.throwError(n):a.of(e.contactApps)})),r.takeUntil(this.unsubscribe$)).subscribe((function(t){e.isLoading=!1;var n,i=e.countContacts(t);n="text",i.sort((function(t,e){var i=t[n].toLowerCase(),o=e[n].toLowerCase();return i<o?-1:i>o?1:0})),e.contactsList=i,e.selectFirstContact()}),(function(){e.isLoading=!1})),[2]}}))}))},t.prototype.selectContactItem=function(t){return j(this,void 0,void 0,(function(){return M(this,(function(e){return this.contactsHelper.activeContact.next(t),this.isMobile?[2,this.router.navigate(["/"+T.contacts+"/"+t.id])]:[2]}))}))},t.prototype.getFullName=function(t){return t?Z([t.first_name,t.name])||"[Unnamed]":""},t.prototype.onResizeEnd=function(t){var e=this;this.appsService.getToken().pipe(r.take(1),r.map((function(t){return JSON.parse(atob(t.split(".")[1])).id})),r.switchMap((function(n){return e.updateAppContactUserSettingsGql.mutate({userId:n,appContactUserSettings:{contactListWidth:t.rectangle.width}})}))).subscribe()},t.prototype.validate=function(t){return!(t.rectangle.width&&t.rectangle.width<150||t.rectangle.width&&t.rectangle.width>500)},t.prototype.searchEvent=function(t){this.searchText=t},t.prototype.fetchMore=function(){this.contactsQueryRef.fetchMore({variables:{page:++this.gqlVariables.page},updateQuery:function(t,e){var n=e.fetchMoreResult;return n?h(t,{contactApps:{items:{$push:n.contactApps.items},pageInfo:{$merge:n.contactApps.pageInfo},aggregatedInfo:{$merge:n.contactApps.aggregatedInfo}}}):t}})},t.prototype.filterByMenu=function(t){switch(this.resetSearch=t,this.gqlVariables.page=1,t.type){case F:this.gqlVariables.filter.logical20=!0;break;case U:this.gqlVariables.filter.logical20=!1;break;default:delete this.gqlVariables.filter.logical20}this.contactsQueryRef.refetch(this.gqlVariables)},t.prototype.countContacts=function(t){var e=t.items,n=t.pageInfo,i=t.aggregatedInfo;return this.setMenuCount({companyCount:i.companiesContactsCount,userCount:i.usersContactsCount,totalCount:n.totalCount}),e.map((function(t){var e=Z([t.first_name,t.name])||"[Unnamed]";return Object.assign({},t,{text:e})}))},t.prototype.setMenuCount=function(t){this.totalCountContacts=t.totalCount,this.menuItems.forEach((function(e){switch(e.type){case U:e.count=t.userCount;break;case F:e.count=t.companyCount;break;default:e.count=t.userCount+t.companyCount}}))},t.prototype.selectFirstContact=function(){!this.isMobile&&this.contactsList.length>0&&this.gqlVariables.page<2&&this.selectContactItem(this.contactsList[0])},t.prototype.toggleMenu=function(){var t=this;this.keyboardHelper.keyboardHeight$.pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.mobileHeight=t.contactsHelper.getMobileHeight(e?"96px":"152px"),t.showMenu=!!e}))},t.prototype.resetVariables=function(t){this.gqlVariables={page:1,perPage:this.itemsPerPage,domain:t,filter:{}}},t.decorators=[{type:e.Component,args:[{selector:"lib-contacts",template:'<div #sideMenu>\n  <sr-sidemenu\n    *ngIf="!showMenu"\n    openMenuText="menu"\n    closeMenuText="close"\n    [data]="menuData"\n    [windowWidth]="windowWidth"\n    [isMenuFloat]="menuFloat"\n    [isExtendedScreenMode]="contactSettings.extendedMode$ | async"\n  ></sr-sidemenu>\n</div>\n\n<sr-content-card\n  class="contacts-container at-bottom"\n  *ngIf="!isLoading; else loading"\n>\n  <div class="contacts-header-wrapper">\n    <header class="contacts-header">\n      <div class="contacts-list-header">\n        <div class="top-block">\n          <lib-selected-menu\n            [items]="menuItems"\n            (selectedEvent)="filterByMenu($event)"\n          ></lib-selected-menu>\n          <sr-button\n            *ngIf="!showMenu"\n            buttonType="icon"\n            iconName="contact-add"\n            class="contact-add"\n          ></sr-button>\n        </div>\n      </div>\n\n      <lib-contact-actions\n        *ngIf="!isMobile"\n        [picture]="(contactsHelper.activeContact | async)?.picture"\n        [fullName]="getFullName(contactsHelper.activeContact | async)"\n      ></lib-contact-actions>\n    </header>\n  </div>\n\n  <div\n    class="left-panel"\n    mwlResizable\n    [enableGhostResize]="false"\n    [resizeEdges]="{ right: true }"\n    (resizeEnd)="onResizeEnd($event)"\n    [validateResize]="validate"\n  >\n    <lib-search-contacts\n      [scrollHeight]="desktopHeight"\n      [gqlVariables]="gqlVariables"\n      [resetSearch]="resetSearch"\n      (searchEvent)="searchEvent($event)"\n      (selectContactItem)="selectContactItem($event)"\n    ></lib-search-contacts>\n\n    <div class="contacts-list-wrapper">\n      <sr-section-list\n        *ngIf="!searchText.length && contactsList.length; else noData"\n        [scrollHeight]="desktopHeight"\n        [totalCountListItems]="totalCountContacts"\n        (fetchMore)="fetchMore()"\n        [activeItemId]="(contactsHelper.activeContact | async)?.id"\n        (selectListItem)="selectContactItem($event)"\n        [listItems]="contactsList"\n        [hasActions]="true"\n      ></sr-section-list>\n\n      <ng-template #noData>\n        <p class="empty-contacts" *ngIf="!searchText.length">No data ...</p>\n      </ng-template>\n    </div>\n  </div>\n\n  \x3c!-- user details column--\x3e\n  <div class="right-panel" *ngIf="!isMobile">\n    <div class="contact-details-body">\n      <lib-contact-detail></lib-contact-detail>\n    </div>\n  </div>\n</sr-content-card>\n\n<ng-template #loading>\n  <sr-progress-spinner backdropColor="#fff"></sr-progress-spinner>\n</ng-template>\n',encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush,styles:[".contacts .container-full{padding-top:0}.contacts-list-header .top-block{display:flex;align-items:center;justify-content:space-between;padding:14px 8px 14px 12px}.contacts-list-header .mat-button-wrapper sr-text{order:-1}.contacts-list-header .mat-icon-button.text{font-weight:600}.contact-add .mat-icon-button.icon{color:var(--sr-base-color)}.search-field .input-wrapper{display:flex;align-items:center;height:48px;padding:4px 16px 4px 28px;border-top:1px solid var(--sr-border-color);border-bottom:1px solid var(--sr-border-color)}.search-field .input-wrapper sr-icon{color:var(--base-gray-64)}.search-field .input-wrapper input{width:100%;padding:0;border:0;font-weight:600}.search-field .input-wrapper .search-icon{margin-right:16px}.search-field .no-data{display:block;padding:16px 16px 16px 68px}@media (max-width:767px){.contacts-container .contact-add{position:fixed;right:8px;bottom:8px;z-index:71}}@media (min-width:768px){.contacts-container .content-card{padding-top:var(--contact-header-height)}.contacts-container .contacts-header{display:flex;border-radius:6px 6px 0 0;box-shadow:var(--sr-shadow-default)}.contacts-container .contacts-header .contacts-list-header{width:var(--contacts-list-width);border-bottom:1px solid var(--sr-border-color)}.contacts-container .contacts-header lib-contact-actions{flex:1}.contacts-container .contacts-header-wrapper{position:fixed;top:calc(var(--header-height) + 35px);width:calc(100% - var(--container-padding) * 2);padding:var(--base-space) var(--base-space) 0;background:var(--white);overflow:hidden;transform:translateX(-5px);z-index:12}.contacts-container .left-panel{position:fixed;top:calc(var(--header-height) + var(--container-top-padding) + var(--base-space) + var(--contact-header-height));bottom:0;display:flex;flex-direction:column;width:var(--contacts-list-width);border-bottom-left-radius:5px;overflow:hidden}.contacts-container .left-panel .contacts-list-wrapper{flex:1}.contacts-container .right-panel{margin-left:var(--contacts-list-width);border-left:1px solid var(--sr-border-color)}.contacts-list-header .top-block{height:72px;padding:3px 16px 4px 24px}.search-field .input-wrapper{border-top:0}sr-content-card{padding:var(--base-space)}.filter-menu{min-width:226px;max-width:300px;margin:8px 0 0 -24px}}@media (min-width:768px) and (orientation:landscape){.contacts-container .contacts-header-wrapper{width:calc(100% - var(--container-padding) - var(--container-left-padding))}}ion-spinner{display:block;margin:0 auto}sr-content-card{display:block;overflow:hidden}.empty-contacts{text-align:center}.info-section{padding:16px 12px;border-top:1px solid var(--sr-border-color)}.info-section .section-header{display:flex;align-items:center;justify-content:space-between;min-height:40px}.info-section .section-header sr-heading{color:var(--sr-light-text-color)}.info-section .section-header .header-actions sr-button{margin-left:8px}.info-section .section-body{margin:10px 0 8px}.info-section .section-body .button-wrapper{margin-top:21px;padding-left:44px}.info-section .section-info-field{display:flex}.info-section .section-info-field:not(:first-child){margin-top:11px}.info-section .section-info-field .field-content{flex-grow:1}.info-section .section-info-field .field-content.contact{display:flex}.info-section .section-info-field .field-content.contact sr-avatar{margin-right:12px}.info-section .section-info-field .field-content.contact sr-link{display:block;margin-top:6px}.info-section .section-info-field .field-content.project{display:flex}.info-section .section-info-field .field-content.project sr-icon{color:var(--base-gray-64)}.info-section .section-info-field .field-content.project sr-price-label{display:inline-block;margin:6px 0 0}.info-section .section-info-field .field-content.project .icon-wrapper{min-width:32px;margin-right:12px;text-align:center}.info-section .section-info-field .field-content.project .divider{display:none}.info-section .section-info-field .field-content.project .field{display:block}.info-section .section-info-field .field-content.contact,.info-section .section-info-field .field-content.contact .info,.info-section .section-info-field .field-content.contact .text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-details-body{display:flex;min-height:100%}.contact-details-body lib-contact-detail{display:flex;flex-direction:column;width:100%}.contact-details-body .info-sections-wrapper{flex-grow:1}.documents-table .sr-header-row{padding-right:40px}.documents-table .folder-row{cursor:pointer}.documents-table .icon-cell{min-width:36px;max-width:36px;color:var(--base-gray-64)}.documents-table .name-cell{flex:2}.documents-table .last-modified-cell{min-width:110px}.documents-table .size-cell{display:none}@media (min-width:768px){:root{--contacts-list-width:263px;--base-space:5px;--contact-header-height:73px;--footer-height:57px}.info-section{padding:23px 24px 21px}.info-section .section-body{margin:10px 0 6px}.info-section .section-info-field .field-content.project sr-price-label{display:inline-block;margin:0}.info-section .section-info-field .field-content.project .project-name{margin-right:5px}.info-section .section-info-field .field-content.project .icon-wrapper{display:flex;justify-content:center;width:32px;margin-right:12px}.info-section .section-info-field .field-content.project .divider{display:inline-block;margin:0 2px;color:var(--sr-light-text-color)}.info-section .section-info-field .field-content.project .field{display:inline-block}.documents-table .name-cell{flex:4}.documents-table .last-modified-cell{min-width:130px}.documents-table .size-cell{display:block;min-width:100px}.sr-modal-container .sr-modal.notes{width:718px}.sr-modal-container .sr-form-field.mat-form-field-appearance-outline .mat-form-field-wrapper{margin-bottom:0;padding-bottom:0}}@media (min-width:1280px){.info-section .section-info-field{position:relative;cursor:pointer}.info-section .section-info-field sr-actions{opacity:0;visibility:hidden;transition:250ms}.info-section .section-info-field:hover sr-actions{opacity:1;visibility:visible}.documents-table sr-table-row{position:relative;cursor:pointer}.documents-table sr-table-row sr-actions{opacity:0;visibility:hidden;transition:250ms}.documents-table sr-table-row:hover sr-actions{opacity:1;visibility:visible}.documents-table .sr-header-row{padding-right:0}.sr-modal-container .sr-modal.notes{width:784px}}.sr-scroller-wrapper{height:100%}"]}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:[i.DOCUMENT]}]},{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]},{type:jt},{type:tt},{type:lt},{type:n.Router},{type:e.ChangeDetectorRef},{type:et},{type:o.Platform},{type:Mt}]},t.propDecorators={sideMenu:[{type:e.ViewChild,args:["sideMenu",{static:!0}]}],contactListWrapper:[{type:e.ViewChild,args:["contactListWrapper",{static:!1}]}]},t}();var Pt=function(){function t(){this.selectedEvent=new e.EventEmitter}return Object.defineProperty(t.prototype,"selectedMenu",{get:function(){var t=this.items.find((function(t){return t.active}));return t.label+" ("+t.count+")"},enumerable:!0,configurable:!0}),t.prototype.clickEvent=function(t){t.active||(this.items.forEach((function(e){e.active=e.type===t.type})),this.selectedEvent.emit(t))},t.decorators=[{type:e.Component,args:[{selector:"lib-selected-menu",template:'<sr-menu\n  menuButtonType="text"\n  xPosition="after"\n  yPosition="below"\n  [buttonText]="selectedMenu"\n  iconName="chevron-down"\n  customMenuClass="filter-menu"\n>\n  <sr-menu-body>\n    <sr-menu-item\n      (click)="clickEvent(item)"\n      [hasCheckMark]="true"\n      [class.active]="item.active"\n      *ngFor="let item of items"\n      itemsPosition="between"\n    >\n      <sr-text>{{ item.label }} ({{ item.count }})</sr-text>\n    </sr-menu-item>\n  </sr-menu-body>\n</sr-menu>\n',styles:[""]}]}],t.propDecorators={items:[{type:e.Input}],selectedEvent:[{type:e.Output}]},t}();var Dt=function(){function t(t,e,n,i){this.appService=t,this.router=e,this.nacCtrl=n,this.contactsHelper=i,this.isMobile=this.contactsHelper.isMobile,this.unsubscribe$=new a.Subject}return t.prototype.ngOnInit=function(){var t=this;this.appService.getDomains().pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.domains=e})),this.appService.getActiveDomain().pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.activeDomain=e}))},t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.handleChangeDomain=function(t){this.router.navigate(["/"+T.contacts]),this.appService.handleChangeDomain(t)},t.prototype.getRoot=function(){return this.nacCtrl.navigateRoot([this.contactsHelper.headerData.path])},t.prototype.getNotificationPage=function(){return this.router.navigate(["/"+T.notifications])},t.prototype.logout=function(){this.appService.logout()},t.decorators=[{type:e.Component,args:[{selector:"lib-header",template:'<sr-header>\n  <sr-header-inner-block blockPosition="left">\n    <sr-button\n      (clickHandler)="getRoot()"\n      buttonType="icon"\n      iconName="arrow-left"\n    ></sr-button>\n    <sr-heading\n      *ngIf="!isMobile"\n      [headingText]="contactsHelper.headerData?.title"\n      headingType="h1"\n    ></sr-heading>\n  </sr-header-inner-block>\n\n  <sr-header-title *ngIf="!isMobile">\n    <sr-icon\n      iconName="c"\n      iconSize="36"\n      isGradientIcon="true"\n      gradientColor="--sr-gradient-cyan"\n    ></sr-icon>\n  </sr-header-title>\n\n  <sr-header-inner-block blockPosition="right">\n    <sr-menu\n      menuButtonType="icon"\n      iconName="notifications"\n      badgeContent="2"\n      xPosition="before"\n      yPosition="below"\n      customMenuClass="notifications header-menu"\n    >\n      <sr-menu-body noPadding="true">\n        <sr-notifications\n          [data]="[\n            {\n              text:\n                \'<b>Michael Klein</b> has shared the <b>Werden Bau</b> project with you.\',\n              time: \'5h\',\n              unread: true\n            },\n            {\n              text: \'You have a new message from <b>Andreas Kolt.</b>\',\n              time: \'Yesterday\',\n              unread: true\n            },\n            {\n              text:\n                \'<b>Martina Müller</b> has shared the <b>Dogo Gartenbau</b> contact with you.\',\n              time: \'May 27\',\n              unread: true\n            },\n            {\n              text: \'You have joined to <b>Sorba Web Container</b>.\',\n              time: \'January 5, 2018\',\n              unread: false\n            }\n          ]"\n        ></sr-notifications>\n      </sr-menu-body>\n      <sr-button\n        buttonType="additional"\n        [isBoxed]="true"\n        (click)="getNotificationPage()"\n        buttonText="Show all"\n      ></sr-button>\n    </sr-menu>\n\n    <sr-menu\n      *ngIf="activeDomain?.name"\n      menuButtonType="avatar"\n      xPosition="before"\n      yPosition="below"\n      [avatarValue]="activeDomain.name.charAt(0)"\n      customMenuClass="domains header-menu"\n    >\n      <sr-menu-header class="main-menu-item">\n        <sr-avatar\n          [avatarSize]="48"\n          [avatarValue]="activeDomain.name.charAt(0)"\n        ></sr-avatar>\n        <sr-text>{{ activeDomain.name }}</sr-text>\n      </sr-menu-header>\n\n      <sr-menu-body>\n        <span *ngFor="let domain of domains">\n          <sr-menu-item\n            *ngIf="activeDomain.name !== domain.name"\n            (click)="handleChangeDomain(domain)"\n          >\n            <sr-avatar\n              [avatarSize]="40"\n              [avatarValue]="domain.name.charAt(0)"\n            ></sr-avatar>\n            <sr-text>{{ domain.name }}</sr-text>\n          </sr-menu-item>\n        </span>\n      </sr-menu-body>\n\n      <sr-menu-footer itemsPosition="end">\n        <sr-button\n          buttonType="primary"\n          buttonText="Sign out"\n          (clickHandler)="logout()"\n        ></sr-button>\n      </sr-menu-footer>\n    </sr-menu>\n  </sr-header-inner-block>\n</sr-header>\n',styles:["@media (min-width:768px){sr-header{display:block;margin-bottom:var(--container-top-padding)}}"]}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]},{type:n.Router},{type:o.NavController},{type:tt}]},t}();var Tt=function(){function t(t,n){var i=this;this.contactsHelper=t,this.searchContactsGQL=n,this.searchEvent=new e.EventEmitter,this.selectContactItem=new e.EventEmitter,this.search=new m.FormControl(""),this.unsubscribe$=new a.Subject,this.searchText="",this.search.valueChanges.pipe(r.debounceTime(400),r.takeUntil(this.unsubscribe$)).subscribe((function(t){return i.searchContact(t&&t.trim())}))}return t.prototype.ngOnChanges=function(t){t.resetSearch&&this.clearInput()},t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},Object.defineProperty(t.prototype,"isSearching",{get:function(){return!!this.searchText.length},enumerable:!0,configurable:!0}),t.prototype.selectContact=function(t){this.selectContactItem.emit(t)},t.prototype.clearInput=function(){this.search.setValue("")},t.prototype.searchContact=function(t){var e=this;if(this.searchText=t,this.searchEvent.emit(t),t&&t.length){this.isLoading=!0;var n=this.gqlVariables.hasOwnProperty("filter")?Object.assign({},this.gqlVariables.filter,{search:t}):{search:t};this.searchContactsGQL.watch({domain:this.gqlVariables.domain,page:1,perPage:1e3,filter:n}).valueChanges.pipe(r.map((function(t){return t.data.contactApps})),r.takeUntil(this.unsubscribe$)).subscribe((function(n){var i=n.items;e.searchList=e.contactsHelper.searchBySymbol(i,t),e.isLoading=!1}))}},t.decorators=[{type:e.Component,args:[{selector:"lib-search-contacts",template:'<div class="search-field">\n  <div class="input-wrapper">\n    <sr-icon iconName="search" class="search-icon"></sr-icon>\n    <input type="search" placeholder="Search" [formControl]="search" />\n    <sr-button\n      *ngIf="isSearching"\n      buttonType="icon"\n      iconName="cross"\n      (clickHandler)="clearInput()"\n    ></sr-button>\n  </div>\n\n  <ng-container *ngIf="isSearching">\n    <div\n      *ngIf="!isLoading; else showSpinner"\n      class="search-result"\n      #searchContent\n    >\n      <sr-section-list\n        *ngIf="searchList?.length; else notFound"\n        [activeItemId]="(contactsHelper.activeContact | async)?.id"\n        [grouping]="false"\n        [searchText]="searchText"\n        [scrollHeight]="scrollHeight"\n        [listItems]="searchList"\n        (selectListItem)="selectContact($event)"\n      ></sr-section-list>\n    </div>\n\n    <ng-template #notFound>\n      <span class="no-data">No match data ...</span>\n    </ng-template>\n\n    <ng-template #showSpinner>\n      <ion-spinner></ion-spinner>\n    </ng-template>\n  </ng-container>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:tt},{type:dt}]},t.propDecorators={searchContent:[{type:e.ViewChild,args:["searchContent",{static:!1}]}],scrollHeight:[{type:e.Input}],resetSearch:[{type:e.Input}],gqlVariables:[{type:e.Input}],searchEvent:[{type:e.Output}],selectContactItem:[{type:e.Output}]},t}();var $t=function(){function t(t,e,n){var i=this;this.contactByIdGQL=t,this.contactHelper=e,this.contactSettings=n,this.contact={},this.unsubscribe$=new a.Subject,this.maxVisibleProjects=3,this.projectSliceEnd=this.maxVisibleProjects,this.windowWidth=window.innerWidth,this.actions=[{icon:"edit",text:"Edit",handler:function(){return console.log("edit")}},{icon:"delete",text:"Delete",handler:function(){return console.log("delete")}}],this.editNote=!0,this.isMobile=this.contactHelper.isMobile,this.isMobile&&(this.contactHelper.headerData={path:"/"+T.contacts,title:""}),this.contactSub$=this.contactHelper.activeContact.pipe(r.filter((function(t){return null!==t})),r.distinctUntilChanged(),r.takeUntil(this.unsubscribe$)),this.contactSub$.subscribe((function(t){i.contact?(Object.assign(i.contact,t),i.fetchLess()):i.contact=S({},t)}))}return t.prototype.ngOnInit=function(){var t=this;this.contactSub$.pipe(r.switchMap((function(e){return t.contactHelper.getActiveDomain().pipe(r.take(1),r.switchMap((function(n){return t.contactByIdGQL.fetch({id:e.id,domain:n})})),r.map((function(t){return t.data.contactAppById})))})),r.filter((function(t){return null!==t}))).subscribe((function(e){Object.assign(t.contact,e)}))},t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.fetchLess=function(){this.projectSliceEnd=this.maxVisibleProjects},t.prototype.fetchMore=function(){this.projectSliceEnd=void 0},t.prototype.getFullName=function(t){return t&&Z([t.first_name,t.name])||"[Unnamed]"},t.prototype.getField=function(t){return t&&t.length>0?t:" - "},t.prototype.addSeparator=function(t,e){return void 0===e&&(e=","),t&&t.length>0?""+t+(e||""):""},t.prototype.trackByFn=function(t,e){return e.id||t},t.prototype.formatAddress=function(t,e,n,i){return(this.addSeparator(t)+" "+e+" "+n+this.addSeparator(i)).trim().replace(/\s{2,}/," ")},t.prototype.getStatus=function(t){switch(!0){case t.specification:return"Specification";case t.offer:return"Offer";case t.done:return"Done";case t.denied:return"Denied";case t.in_progress:default:return"In progress"}},t.decorators=[{type:e.Component,args:[{selector:"lib-contact-detail",template:'<lib-contact-actions\n  *ngIf="isMobile"\n  [picture]="contact.picture"\n  [fullName]="getFullName(contact)"\n></lib-contact-actions>\n\n<div\n  class="info-sections-wrapper"\n  [ngClass]="{ extended: contactSettings.extendedMode$ | async }"\n>\n  <div class="group">\n    \x3c!-- main info --\x3e\n    <div class="main-info-section">\n      <sr-heading headingText="Contact Details" headingType="h3"></sr-heading>\n\n      <ul class="info-list">\n        <li class="info-list-item">\n          <div class="cell label">Business number</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.business_number) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Mobile number</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.mobile_number) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Private Number</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.private_number) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Fax</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.fax) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Email</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.email) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Website</div>\n          <div class="cell value">\n            <sr-text>{{ getField(contact.website) }}</sr-text>\n          </div>\n        </li>\n        <li class="info-list-item">\n          <div class="cell label">Address</div>\n          <div class="cell value">\n            <sr-text>{{ addSeparator(contact.address) }}</sr-text>\n            <sr-text\n              >{{ contact.postal_code }}\n              {{ contact.city }}\n              {{ contact.po_box ? \',\' : \'\' }}</sr-text\n            >\n            <sr-text>{{ contact.po_box }}</sr-text>\n          </div>\n        </li>\n      </ul>\n      <div class="map-container">\n        <agm-map\n          [latitude]="contact?.geocode_address?.lat"\n          [longitude]="contact?.geocode_address?.lon"\n          [draggable]="false"\n          [panControl]="false"\n          [zoom]="15"\n          [scaleControl]="false"\n          [zoomControl]="false"\n        >\n          <agm-marker\n            [latitude]="contact?.geocode_address?.lat"\n            [longitude]="contact?.geocode_address?.lon"\n          ></agm-marker>\n        </agm-map>\n      </div>\n    </div>\n\n    \x3c!-- notes --\x3e\n    <lib-contact-notes [contact]="contact"></lib-contact-notes>\n  </div>\n\n  <div class="group">\n    \x3c!-- contact persons --\x3e\n    <div class="info-section">\n      <header class="section-header">\n        <sr-heading headingText="Contact Persons" headingType="h3"></sr-heading>\n        <sr-button buttonType="icon" iconName="add-circle"></sr-button>\n      </header>\n      <div\n        class="section-body"\n        *ngIf="contact.contacts && contact.contacts.length"\n      >\n        <div\n          class="section-info-field"\n          *ngFor="let c of contact.contacts; trackBy: trackByFn"\n        >\n          <div class="field-content contact">\n            <sr-avatar\n              [avatarValue]="getFullName(c).charAt(0)"\n              [imageUrl]="c.picture"\n            ></sr-avatar>\n            <div class="info">\n              <sr-link [linkUrl]="\'#/contacts/contact\'">{{\n                getFullName(c)\n              }}</sr-link>\n              <sr-text textType="complementary">{{\n                formatAddress(c.address, c.postal_code, c.city, c.po_box)\n              }}</sr-text>\n            </div>\n          </div>\n          <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- projects --\x3e\n    <div class="info-section">\n      <header class="section-header">\n        <sr-heading headingText="Projects" headingType="h3"></sr-heading>\n        <sr-button buttonType="icon" iconName="add-circle"></sr-button>\n      </header>\n      <div\n        class="section-body"\n        *ngIf="contact.projects && contact.projects.length"\n      >\n        <div\n          class="section-info-field"\n          *ngFor="\n            let project of contact.projects | slice: 0:projectSliceEnd;\n            trackBy: trackByFn\n          "\n        >\n          <div class="field-content project">\n            <div class="icon-wrapper">\n              <sr-icon iconName="case"></sr-icon>\n            </div>\n            <div class="info">\n              <div>\n                <sr-link [linkUrl]="\'#/contacts/contact\'" class="project-name">\n                  {{ project.name }} {{ project.description }}\n                </sr-link>\n                <sr-price-label *ngIf="!isMobile">{{\n                  project.offer_total | currency: \'EUR\'\n                }}</sr-price-label>\n              </div>\n              <sr-text textType="complementary">\n                <span class="field order"\n                  >Order-No.: {{ project.order_no }}</span\n                >\n                <span class="divider">/</span>\n                <span class="field responsible"\n                  >Responsible:\n                  <sr-link [linkUrl]="\'#/contacts/contact\'">{{\n                    project.responsible || \'-\'\n                  }}</sr-link></span\n                >\n                <span class="divider">/</span>\n                <span class="field status"\n                  >Status: {{ getStatus(project) }}</span\n                >\n              </sr-text>\n              <sr-price-label *ngIf="isMobile">{{\n                project.offer_total | currency: \'EUR\'\n              }}</sr-price-label>\n            </div>\n          </div>\n          <sr-actions [windowWidth]="windowWidth" [data]="actions"></sr-actions>\n        </div>\n        <div\n          class="button-wrapper"\n          *ngIf="contact?.projects?.length > maxVisibleProjects"\n        >\n          <sr-button\n            (clickHandler)="fetchMore()"\n            *ngIf="projectSliceEnd > 0"\n            buttonText="Show more"\n            buttonType="link"\n          >\n          </sr-button>\n          <sr-button\n            (clickHandler)="fetchLess()"\n            *ngIf="!projectSliceEnd"\n            buttonText="Show less"\n            buttonType="link"\n          >\n          </sr-button>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- documents --\x3e\n    <lib-documents\n      [documents]="contact.documents && contact.documents[\'root\']"\n    ></lib-documents>\n  </div>\n</div>\n',styles:["agm-map{height:160px}.main-info-section{padding:24px 12px}.main-info-section ::ng-deep .sub-heading{margin-bottom:14px;color:var(--base-gray-48)}.main-info-section .info-list-item:not(:last-child){padding-bottom:9px}.main-info-section .info-list-item .value{color:var(--sr-base-color)}.main-info-section .map-container{margin-top:23px}.info-sections-wrapper.extended{display:flex}.info-sections-wrapper.extended .group{width:50%}.info-sections-wrapper.extended .group:first-child{border-right:1px solid var(--sr-border-color)}.info-sections-wrapper.extended .info-section:first-child{border:0}@media (min-width:768px){agm-map{height:216px}.main-info-section{padding:29px 24px 31px}.main-info-section .info-list-item{display:table-row}.main-info-section .info-list-item:not(:last-child) .cell{padding-bottom:8px}.main-info-section .info-list-item .cell{display:table-cell}.main-info-section .info-list-item .label{padding-right:14px;text-align:right}.main-info-section .map-container{height:216px;margin-top:31px}}"]}]}],t.ctorParameters=function(){return[{type:ht},{type:tt},{type:Mt}]},t}();var Nt=function(){function t(t,e,n){var i=this;this.appsService=t,this.updateAppContactUserSettingsGql=e,this.unsubscribe$=new a.Subject,this.isExtendedLayout=!1,n.extendedMode$.pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){i.isExtendedLayout=t}))}return Object.defineProperty(t.prototype,"avatarSize",{get:function(){return window.innerWidth<768?36:40},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showContact",{get:function(){return window.innerWidth<1024},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showActions",{get:function(){return window.innerWidth>1023},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.toggleScreenMode=function(){return j(this,void 0,void 0,(function(){var t=this;return M(this,(function(e){return this.appsService.getToken().pipe(r.take(1),r.map((function(t){return JSON.parse(atob(t.split(".")[1])).id})),r.switchMap((function(e){return t.updateAppContactUserSettingsGql.mutate({userId:e,appContactUserSettings:{extendedLayout:!t.isExtendedLayout}})}))).subscribe(),[2]}))}))},t.decorators=[{type:e.Component,args:[{selector:"lib-contact-actions",template:'<header class="contact-details-header">\n  <div class="contact-base-info">\n    <sr-avatar\n      [avatarValue]="fullName.charAt(0)"\n      [avatarSize]="avatarSize"\n      [imageUrl]="picture"\n    ></sr-avatar>\n    <sr-heading [headingText]="fullName"></sr-heading>\n  </div>\n\n  <div class="contact-actions" *ngIf="showContact">\n    <sr-menu\n      menuButtonType="icon"\n      iconName="more-vertical"\n      class="contact-actions"\n      xPosition="before"\n    >\n      <sr-menu-body>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon iconName="file-export"></sr-icon>\n          <sr-text>Export</sr-text>\n        </sr-menu-item>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon iconName="print"></sr-icon>\n          <sr-text>Print</sr-text>\n        </sr-menu-item>\n        <sr-menu-item\n          [hasCheckMark]="true"\n          itemsPosition="between"\n          class="contact-action"\n        >\n          <sr-icon iconName="edit"></sr-icon>\n          <sr-text>Edit</sr-text>\n        </sr-menu-item>\n        <sr-menu-item [hasCheckMark]="true" class="contact-action">\n          <sr-icon iconName="delete"></sr-icon>\n          <sr-text>Delete</sr-text>\n        </sr-menu-item>\n      </sr-menu-body>\n    </sr-menu>\n  </div>\n\n  <div class="contact-actions" *ngIf="showActions">\n    <sr-button buttonType="icon" iconName="file-export"></sr-button>\n    <sr-button buttonType="icon" iconName="print"></sr-button>\n    <sr-button buttonType="icon" iconName="edit"></sr-button>\n    <sr-button buttonType="icon" iconName="delete"></sr-button>\n    <span class="divider"></span>\n    <sr-button\n      buttonType="icon"\n      [iconName]="isExtendedLayout ? \'two-column-view\' : \'three-column-view\'"\n      (clickHandler)="toggleScreenMode()"\n    ></sr-button>\n  </div>\n</header>\n',styles:[".contact-details-header{display:flex;align-items:center;justify-content:space-between;padding:13px 12px 10px;border-bottom:1px solid var(--sr-border-color)}.contact-details-header sr-avatar{margin-right:8px}.contact-details-header sr-heading{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-details-header ::ng-deep .heading{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-base-info{display:flex;align-items:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.contact-action sr-icon{margin-right:16px;color:var(--base-gray-64)}@media (min-width:768px){.contact-details-header{padding:16px 16px 16px 24px;border-left:1px solid var(--sr-border-color)}.contact-details-header sr-avatar{margin-right:12px}.contact-details-header sr-button{margin-left:8px}.contact-details-header .divider{width:1px;margin-left:8px;background:var(--sr-border-color)}.contact-details-header .contact-actions{display:flex}}"]}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]},{type:jt},{type:Mt}]},t.propDecorators={fullName:[{type:e.Input}],picture:[{type:e.Input}]},t}();var Lt=function(){function t(t,e,n){this.linkRedirect=t,this.contactsHelper=e,this.appService=n,this.isMobile=this.contactsHelper.isMobile,this.isDesktop=this.contactsHelper.isDesktop,this.privacyPolicy="#/"+W.PRIVACY_POLICY,this.helpCenter=W.HELP_CENTER,this.privacy="Privacy",this.policy="Privacy Policy",this.service="Terms of Service",this.terms="Terms",this.center="Help Center",this.help="Help",this.activeLanguage="",this.unsubscribe$=new a.Subject,this.getLanguages()}return t.prototype.ngOnDestroy=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},Object.defineProperty(t.prototype,"getText",{get:function(){return this.isDesktop?this.policy:this.privacy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonText",{get:function(){return this.isDesktop?this.service:this.terms},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getHelpText",{get:function(){return this.isDesktop?this.center:this.help},enumerable:!0,configurable:!0}),t.prototype.getLanguages=function(){var t=this;this.languages$=this.appService.getLanguages().pipe(r.takeUntil(this.unsubscribe$)),this.appService.getActiveLanguage().pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){t.activeLanguage=e}))},t.prototype.getHelpCenter=function(t){this.linkRedirect.redirect(t,this.helpCenter)},t.prototype.handleChangeLanguage=function(t){return j(this,void 0,void 0,(function(){return M(this,(function(e){return t===this.activeLanguage?[2,null]:(this.appService.changeLanguage(t),[2])}))}))},t.prototype.uppercase=function(t){return t.charAt(0).toUpperCase()+t.substr(1,t.length-1).toLowerCase()},t.decorators=[{type:e.Component,args:[{selector:"lib-footer",template:'<sr-footer *ngIf="!isMobile">\n  <div class="row">\n    <div class="col xs-4 m-4 l-5">\n      <sr-text class="copyright">&copy; 2019 Sorba</sr-text>\n    </div>\n    <div class="col xs-8 m-4 l-5 last-m">\n      <sr-buttons-group buttonsPosition="end">\n        <sr-link linkColor="gray" linkSize="small" [linkUrl]="privacyPolicy">{{\n          getText\n        }}</sr-link>\n        \x3c!--        <sr-link linkColor="gray" linkSize="small">--\x3e\n        \x3c!--          {{isDesktop ? \'Terms of Service\' : \'Terms\'}}--\x3e\n        \x3c!--        </sr-link>--\x3e\n        <lib-terms-button [buttonText]="buttonText"></lib-terms-button>\n        <sr-link\n          linkColor="gray"\n          linkSize="small"\n          (click)="getHelpCenter($event)"\n          >{{ getHelpText }}</sr-link\n        >\n      </sr-buttons-group>\n    </div>\n    <div class="col m-4 l-2">\n      <sr-buttons-group buttonsPosition="center">\n        <sr-menu\n          menuButtonType="text"\n          xPosition="after"\n          yPosition="above"\n          [buttonText]="uppercase(activeLanguage)"\n          iconName="language"\n          customMenuClass="languages footer-menu"\n        >\n          <sr-menu-body>\n            <sr-menu-item\n              *ngFor="let language of languages$ | async"\n              [hasCheckMark]="true"\n              (click)="handleChangeLanguage(language)"\n              [class.active]="language === activeLanguage"\n              itemsPosition="between"\n            >\n              <sr-text>{{ uppercase(language) }}</sr-text>\n            </sr-menu-item>\n          </sr-menu-body>\n        </sr-menu>\n      </sr-buttons-group>\n    </div>\n  </div>\n</sr-footer>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:nt},{type:tt},{type:void 0,decorators:[{type:e.Inject,args:["appService"]}]}]},t}();var Ht=function(){function t(t,e,n,i,o){this.linkRedirect=t,this.document=e,this.file=n,this.fileOpener=i,this.platformHelper=o,this.termsOfService=W.TERMS_OF_SERVICE}return t.prototype.openTermsOfService=function(){var t=this,e=this.file.applicationDirectory+"www/assets/docs";if(this.platformHelper.isIOS())this.document.viewDocument(e+"/2019_AGB_SORBA_EDV_AG.pdf","application/pdf",{});else if(this.platformHelper.isAndroid()){var n=Date.now();this.file.copyFile(e,"2019_AGB_SORBA_EDV_AG.pdf",this.file.dataDirectory,n+".pdf").then((function(e){t.fileOpener.open(e.nativeURL,"application/pdf").catch((function(t){return console.log(t)}))}))}},t.decorators=[{type:e.Component,args:[{selector:"lib-terms-button",template:'<sr-button\n  *ngIf="!platformHelper.isDesktop()"\n  buttonType="text"\n  (clickHandler)="openTermsOfService()"\n  >{{ buttonText }}</sr-button\n>\n<sr-link\n  *ngIf="platformHelper.isDesktop()"\n  (click)="linkRedirect.redirect($event, termsOfService)"\n  linkColor="gray"\n  linkSize="small"\n>\n  {{ buttonText }}\n</sr-link>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:nt},{type:g.DocumentViewer},{type:y.File},{type:v.FileOpener},{type:it}]},t.propDecorators={buttonText:[{type:e.Input}]},t}();var _t=function(){function t(t,e,n){this.contactHelper=t,this.platform=e,this.fileService=n,this.subject$=new a.Subject,this.breadCrumbLimit=3,this.breadcrumbs=[],this.docActions=[],this.windowWidth=window.innerWidth,this.sortFields={name:"up",lastModified:null,size:null},this.setDocActions(),this.getActiveDomain(),this.contactHelper.isMobile&&(this.breadCrumbLimit=2)}return t.prototype.setDocActions=function(){var t=this;B.forEach((function(e){t.docActions.push({icon:e,text:t.getCapitalizeString(e),handler:function(){return t.actionName=e}})})),this.contactHelper.isDesktop||(this.docActions=this.docActions.filter((function(t){return t.icon!==L})))},t.prototype.getCapitalizeString=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.prototype.onActionEvent=function(t){if(this.contactHelper.isDesktop)switch(this.actionName){case L:this.downloadFile(t.path);break;case H:console.log("copy")}},t.prototype.getActions=function(t){return t.type===_?this.docActions:this.docActions.filter((function(t){return t.icon!==L}))},t.prototype.downloadFile=function(t){return j(this,void 0,void 0,(function(){var e;return M(this,(function(n){switch(n.label){case 0:return[4,this.contactHelper.getDownLoadPath(t,this.activeDomain)];case 1:return e=n.sent(),window.open(e),[2]}}))}))},t.prototype.ngOnChanges=function(){this.documents&&this.getBreadCrumbs(this.documents)},t.prototype.ngOnDestroy=function(){this.subject$.next(),this.subject$.complete()},t.prototype.getActiveDomain=function(){var t=this;this.contactHelper.getActiveDomain().pipe(r.takeUntil(this.subject$)).subscribe((function(e){return t.activeDomain=e}))},t.prototype.getBreadCrumbs=function(t){this.folderName="Root folder",this.rootDocs={},this.breadcrumbs=[],this.checkEmptyDocs(t)&&(this.setDocumentStructure(t,this.folderName),this.getFileFolder({name:this.folderName,type:E}))},t.prototype.checkEmptyDocs=function(t){return Object.values(t).some((function(t){return Object.keys(t).length}))},t.prototype.setDocumentStructure=function(t,e){var n,i,o,r;this.rootDocs[e]=[];try{for(var a=A(Object.entries(t)),s=a.next();!s.done;s=a.next()){var c=P(s.value,2),l=c[0],p=c[1];if(["folders","files"].includes(l))try{for(var d=(o=void 0,A(Object.entries(p))),u=d.next();!u.done;u=d.next()){var h=P(u.value,2),f=h[0],m=h[1],b=m,g=_;"folders"===l&&(g=E,this.setDocumentStructure(m,f)),this.rootDocs[e].push({type:g,name:f,lastModified:+new Date(b.updated_at),size:b.size,ext:b.ext,path:b.path||null})}}catch(t){o={error:t}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},t.prototype.getFileFolder=function(t){var e=this;if(t.type===E)return this.folderName=t.name,this.breadcrumbs.push({type:"item",text:t.name,handler:function(){return e.breadCrumbHandler(t.name)}}),void this.handleBread();this.previewFile(t)},t.prototype.previewFile=function(t){return j(this,void 0,void 0,(function(){var e,n,i;return M(this,(function(o){switch(o.label){case 0:return e=t.ext&&t.ext.toLowerCase(),[q.jpg,q.jpeg,q.docx,q.pdf,q.xslx,q.xls].includes(e)?[4,this.contactHelper.getDownLoadPath(t.path,this.activeDomain)]:(this.fileService.errorMessage("Not supported file"),[2]);case 1:return n=o.sent(),this.platform.is(K)?this.fileService.previewFileMobile(n,e):(i=[q.jpg,q.jpeg].includes(e)?e:_,this.fileService.previewFileWeb(n,i)),[2]}}))}))},t.prototype.breadCrumbHandler=function(t){var e=this.findIndexByName(this.breadcrumbs,t);this.breadcrumbs=e<0?this.getBreadCrumbList(t):this.breadcrumbs.slice(0,e+1),this.folderName=t,this.handleBread()},t.prototype.getBreadCrumbList=function(t){var e=[this.breadcrumbs[0]],n=this.breadcrumbs.find((function(t){return t.hasOwnProperty("itemsList")})),i=this.findIndexByName(n.itemsList,t);return this.spliceArray(n.itemsList,i).forEach((function(t){return e.push(t)})),e},t.prototype.findIndexByName=function(t,e){return t.findIndex((function(t){return t.text===e}))},t.prototype.spliceArray=function(t,e){return t.slice(0,e+1)},t.prototype.handleBread=function(){var t=this,e=[];this.breadcrumbs.length>this.breadCrumbLimit&&(this.breadcrumbs.forEach((function(n,i){if(i)if(i+(t.breadCrumbLimit-1)>=t.breadcrumbs.length)e.push(n);else{var o=e.find((function(t){return t.hasOwnProperty("itemsList")}));"list"===n.type?o.itemsList=n.itemsList:o.itemsList.push(n)}else e.push(n,{type:"list",itemsList:[]})})),this.breadcrumbs=e)},t.prototype.sortTable=function(t){var e=this.sortFields[t]===$;this.rootDocs[this.folderName].sort((function(n,i){return(n[t]<i[t]?-1:1)*(e?1:-1)}))},t.prototype.getSortType=function(t){return this.sortFields[t]?"header-cell-sort":"header-cell"},t.prototype.sort=function(t){for(var e in this.sortFields)this.sortFields[e]=e===t?this.sortFields[e]===$?N:$:null;this.sortTable(t)},t.decorators=[{type:e.Component,args:[{selector:"lib-documents",template:'<div class="info-section">\n  <header class="section-header">\n    <sr-heading headingText="Documents" headingType="h3"></sr-heading>\n    <div class="header-actions">\n      <sr-button\n        buttonType="icon"\n        iconName="paste"\n        [isDisabled]="true"\n      ></sr-button>\n      <sr-button buttonType="icon" iconName="new-folder"></sr-button>\n      <sr-button buttonType="icon" iconName="cloud-upload"></sr-button>\n    </div>\n  </header>\n\n  <div class="section-body" *ngIf="breadcrumbs.length">\n    <sr-breadcrumbs [data]="breadcrumbs"></sr-breadcrumbs>\n\n    <sr-table class="documents-table">\n      <sr-table-row rowType="header-row">\n        <sr-table-cell class="icon-cell" cellType="header-cell"></sr-table-cell>\n        <sr-table-cell\n          (click)="sort(\'name\')"\n          class="name-cell"\n          title="Name"\n          [cellType]="getSortType(\'name\')"\n          [sortIcon]="sortFields.name"\n        ></sr-table-cell>\n        <sr-table-cell\n          (click)="sort(\'lastModified\')"\n          class="last-modified-cell"\n          title="Last modified"\n          [cellType]="getSortType(\'lastModified\')"\n          [sortIcon]="sortFields.lastModified"\n        ></sr-table-cell>\n        <sr-table-cell\n          (click)="sort(\'size\')"\n          class="size-cell"\n          title="Size"\n          [cellType]="getSortType(\'size\')"\n          [sortIcon]="sortFields.size"\n        ></sr-table-cell>\n      </sr-table-row>\n\n      <sr-table-row\n        class="folder-row"\n        *ngFor="let doc of rootDocs && rootDocs[folderName]"\n      >\n        <sr-table-cell class="icon-cell">\n          <sr-icon [iconName]="doc?.type"></sr-icon>\n        </sr-table-cell>\n        <sr-table-cell class="name-cell" (click)="getFileFolder(doc)">\n          <span [title]="doc.name">{{ doc.name }}</span>\n        </sr-table-cell>\n        <sr-table-cell class="last-modified-cell">{{\n          doc.lastModified | date: \'MMM d, y\'\n        }}</sr-table-cell>\n        <sr-table-cell class="size-cell">{{\n          doc.size | fileSize\n        }}</sr-table-cell>\n        <sr-actions\n          (click)="onActionEvent(doc)"\n          [windowWidth]="windowWidth"\n          [data]="getActions(doc)"\n        ></sr-actions>\n      </sr-table-row>\n    </sr-table>\n  </div>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:tt},{type:o.Platform},{type:void 0,decorators:[{type:e.Inject,args:["fileService"]}]}]},t.propDecorators={documents:[{type:e.Input}]},t}();var Et=function(){function t(t){var e=this;this.fb=t,this.contact={},this.windowWidth=window.innerWidth,this.editNote=!1,this.addNote=!1,this.tabletWidth=768,this.noteText="Note",this.errorMessages={required:"Field is required"},this.actions=[{icon:"edit",text:"Edit",handler:function(){return e.toggleEditNoteModal()}},{icon:"delete",text:"Delete",handler:function(){return console.log("delete")}}],this.form=this.fb.group({text:[null,[m.Validators.required]]})}return t.prototype.toggleEditNoteModal=function(){this.editNote=!this.editNote},t.prototype.editNoteSubmit=function(){console.log("submit",this.form.value)},t.prototype.toggleAddNoteModal=function(){this.addNote=!this.addNote},t.prototype.addNoteSubmit=function(){console.log("submit",this.form.value)},t.decorators=[{type:e.Component,args:[{selector:"lib-contact-notes",template:'\x3c!-- notes --\x3e\n<div class="info-section">\n  <header class="section-header">\n    <sr-heading headingText="notes" headingType="h3"></sr-heading>\n    <sr-button\n      *ngIf="!(contact && contact?.memo)"\n      buttonType="icon"\n      iconName="add-circle"\n      (clickHandler)="toggleAddNoteModal()"\n    >\n    </sr-button>\n  </header>\n  <form *ngIf="addNote" [formGroup]="form" (keyup.enter)="addNoteSubmit()">\n    <sr-modal-dialog\n      modalTitle="Add note"\n      cancelButtonText="Cancel"\n      submitButtonText="Save"\n      [isSubmitDisabled]="form.invalid"\n      customModalClass="notes"\n      (clickHandlerSubmit)="addNoteSubmit()"\n      (clickHandlerClose)="toggleAddNoteModal()"\n    >\n      <sr-textarea-field\n        [formControl]="form.controls.text"\n        [placeholder]="windowWidth < tabletWidth ? noteText : \'\'"\n        [labelText]="windowWidth >= tabletWidth ? noteText : \'\'"\n        [errorMessages]="errorMessages"\n        rowsCount="12"\n      >\n      </sr-textarea-field>\n    </sr-modal-dialog>\n  </form>\n  <div class="section-body" *ngIf="contact && contact?.memo">\n    <form *ngIf="editNote" [formGroup]="form" (keyup.enter)="editNoteSubmit()">\n      <sr-modal-dialog\n        modalTitle="Edit note"\n        cancelButtonText="Cancel"\n        submitButtonText="Save"\n        [isSubmitDisabled]="form.invalid"\n        customModalClass="notes"\n        (clickHandlerSubmit)="editNoteSubmit()"\n        (clickHandlerClose)="toggleEditNoteModal()"\n      >\n        <sr-textarea-field\n          [formControl]="form.controls.text"\n          [placeholder]="windowWidth < tabletWidth ? noteText : \'\'"\n          [labelText]="windowWidth >= tabletWidth ? noteText : \'\'"\n          [errorMessages]="errorMessages"\n          rowsCount="12"\n        >\n        </sr-textarea-field>\n      </sr-modal-dialog>\n    </form>\n    <div class="section-info-field">\n      <div class="field-content">\n        <sr-text [innerHTML]="contact?.memo | nl2br"></sr-text>\n      </div>\n      <sr-actions\n        *ngIf="contact?.memo"\n        [windowWidth]="windowWidth"\n        [data]="actions"\n      ></sr-actions>\n    </div>\n  </div>\n</div>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:m.FormBuilder}]},t.propDecorators={contact:[{type:e.Input}]},t}();var Ot=function(){function t(){}return t.prototype.transform=function(t,e,n){return n&&t&&t.length&&t.length>e?t.substr(0,e)+" ...":t},t.decorators=[{type:e.Pipe,args:[{name:"stringLimit"}]}],t}(),Ut=function(){function t(t){this.sanitizer=t}return t.prototype.transform=function(t){if("string"!=typeof t||""===t)return t;var n=t.replace(/(\r\n|\r|\n|\\r\\n|\\r|\\n)/g,"<br />");return this.sanitizer.sanitize(e.SecurityContext.HTML,n)},t.decorators=[{type:e.Pipe,args:[{name:"nl2br"}]}],t.ctorParameters=function(){return[{type:w.DomSanitizer}]},t}();var Ft=function(){function t(){this.units=["B","KB","MB","GB","TB","PB"]}return t.prototype.transform=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=2),isNaN(parseFloat(String(t)))||!isFinite(t))return"?";for(var n=0;t>=1024;)t/=1024,n++;return t.toFixed(+e)+" "+this.units[n]},t.decorators=[{type:e.Pipe,args:[{name:"fileSize"}]}],t}();var qt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[f.SorbaUiComponentsModule,o.IonicModule,i.CommonModule,x.ScrollingModule,m.ReactiveFormsModule,b.AgmCoreModule.forRoot({apiKey:"AIzaSyBfnFP4_clqP63H0yaEUIEc84FhGK8y1Ng"})],exports:[f.SorbaUiComponentsModule,o.IonicModule,i.CommonModule,m.ReactiveFormsModule,Dt,Tt,Pt,$t,Nt,Lt,Ht,Ot,Ut,Ft],declarations:[Dt,Tt,Pt,$t,Nt,Lt,Ht,_t,Et,Ot,Ut,Ft],providers:[tt,et]}]}],t}(),Bt=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"lib-root-contact",template:'\n    <lib-header></lib-header>\n    <sr-content id="sr-content-main">\n      <sr-container\n        noPadding="horizontal-top"\n        [isContainerFull]="true"\n        class="contacts"\n      >\n        <router-outlet></router-outlet>\n      </sr-container>\n\n      <lib-footer></lib-footer>\n    </sr-content>\n  '}]}],t.ctorParameters=function(){return[]},t}(),zt=[{path:"",component:Bt,children:[{path:"contact",component:At},{path:":id",component:$t},{path:"**",redirectTo:"contact"}]},{path:"**",redirectTo:""}],Rt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[At,Bt],exports:[At,Bt],imports:[qt,n.RouterModule.forChild(zt),I.ResizableModule]}]}],t}();t.ContactsModule=Rt,t.ɵa=At,t.ɵb=lt,t.ɵc=jt,t.ɵd=tt,t.ɵe=et,t.ɵf=Mt,t.ɵg=Bt,t.ɵh=qt,t.ɵi=Dt,t.ɵj=Tt,t.ɵk=Pt,t.ɵl=$t,t.ɵm=Nt,t.ɵn=Lt,t.ɵo=Ht,t.ɵp=Ot,t.ɵq=Ut,t.ɵr=Ft,t.ɵs=_t,t.ɵt=Et,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=contacts.umd.min.js.map